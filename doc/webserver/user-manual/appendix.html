<HTML
><HEAD
><TITLE
>Appendix</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.64
"><LINK
REL="HOME"
TITLE="Privoxy User Manual"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="See Also"
HREF="seealso.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="../p_doc.css"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#EEEEEE"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Privoxy User Manual</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="seealso.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
>&nbsp;</TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="APPENDIX"
>9. Appendix</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="REGEX"
>9.1. Regular Expressions</A
></H2
><P
> <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> can use <SPAN
CLASS="QUOTE"
>"regular expressions"</SPAN
> 
 in various config files. Assuming support for <SPAN
CLASS="QUOTE"
>"pcre"</SPAN
> (Perl
 Compatible Regular Expressions) is compiled in, which is the default. Such
 configuration directives do not require regular expressions, but they can be
 used to increase flexibility by matching a pattern with wild-cards against
 URLs.</P
><P
> If you are reading this, you probably don't understand what <SPAN
CLASS="QUOTE"
>"regular
 expressions"</SPAN
> are, or what they can do. So this will be a very brief
 introduction only. A full explanation would require a book ;-)</P
><P
> <SPAN
CLASS="QUOTE"
>"Regular expressions"</SPAN
> is a way of matching one character
 expression against another to see if it matches or not. One of the
 <SPAN
CLASS="QUOTE"
>"expressions"</SPAN
> is a literal string of readable characters
 (letter, numbers, etc), and the other is a complex string of literal
 characters combined with wild-cards, and other special characters, called
 meta-characters. The <SPAN
CLASS="QUOTE"
>"meta-characters"</SPAN
> have special meanings and
 are used to build the complex pattern to be matched against. Perl Compatible
 Regular Expressions is an enhanced form of the regular expression language
 with backward compatibility.</P
><P
> To make a simple analogy, we do something similar when we use wild-card
 characters when listing files with the <B
CLASS="COMMAND"
>dir</B
> command in DOS. 
 <TT
CLASS="LITERAL"
>*.*</TT
> matches all filenames. The <SPAN
CLASS="QUOTE"
>"special"</SPAN
>
 character here is the asterisk which matches any and all characters. We can be
 more specific and use <TT
CLASS="LITERAL"
>?</TT
> to match just individual
 characters. So <SPAN
CLASS="QUOTE"
>"dir file?.text"</SPAN
> would match
 <SPAN
CLASS="QUOTE"
>"file1.txt"</SPAN
>, <SPAN
CLASS="QUOTE"
>"file2.txt"</SPAN
>, etc. We are pattern
 matching, using a similar technique to <SPAN
CLASS="QUOTE"
>"regular expressions"</SPAN
>!</P
><P
> Regular expressions do essentially the same thing, but are much, much more
 powerful. There are many more <SPAN
CLASS="QUOTE"
>"special characters"</SPAN
> and ways of 
 building complex patterns however. Let's look at a few of the common ones,
 and then some examples:</P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>  <I
CLASS="EMPHASIS"
>.</I
> - Matches any single character, e.g. <SPAN
CLASS="QUOTE"
>"a"</SPAN
>,
  <SPAN
CLASS="QUOTE"
>"A"</SPAN
>, <SPAN
CLASS="QUOTE"
>"4"</SPAN
>, <SPAN
CLASS="QUOTE"
>":"</SPAN
>, or <SPAN
CLASS="QUOTE"
>"@"</SPAN
>.
 </TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>  <I
CLASS="EMPHASIS"
>?</I
> - The preceding character or expression is matched ZERO or ONE
  times. Either/or.
 </TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>  <I
CLASS="EMPHASIS"
>+</I
> - The preceding character or expression is matched ONE or MORE
  times.
 </TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>  <I
CLASS="EMPHASIS"
>*</I
> - The preceding character or expression is matched ZERO or MORE
  times.
 </TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>  <I
CLASS="EMPHASIS"
>\</I
> - The <SPAN
CLASS="QUOTE"
>"escape"</SPAN
> character denotes that
  the following character should be taken literally. This is used where one of the 
  special characters (e.g. <SPAN
CLASS="QUOTE"
>"."</SPAN
>) needs to be taken literally and
  not as a special meta-character.
 </TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>  <I
CLASS="EMPHASIS"
>[]</I
> - Characters enclosed in brackets will be matched if
  any of the enclosed characters are encountered.
 </TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>  <I
CLASS="EMPHASIS"
>()</I
> - parentheses are used to group a sub-expression,
  or multiple sub-expressions.
 </TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>  <I
CLASS="EMPHASIS"
>|</I
> - The <SPAN
CLASS="QUOTE"
>"bar"</SPAN
> character works like an
  <SPAN
CLASS="QUOTE"
>"or"</SPAN
> conditional statement. A match is successful if the
  sub-expression on either side of <SPAN
CLASS="QUOTE"
>"|"</SPAN
> matches.
 </TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>  <I
CLASS="EMPHASIS"
>s/string1/string2/g</I
> - This is used to rewrite strings of text. 
  <SPAN
CLASS="QUOTE"
>"string1"</SPAN
> is replaced by <SPAN
CLASS="QUOTE"
>"string2"</SPAN
> in this
  example.
 </TD
></TR
></TBODY
></TABLE
><P
></P
><P
> These are just some of the ones you are likely to use when matching URLs with 
 <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
>, and is a long way from a definitive
 list. This is enough to get us started with a few simple examples which may
 be more illuminating:</P
><P
> <I
CLASS="EMPHASIS"
><TT
CLASS="LITERAL"
>/.*/banners/.*</TT
></I
> - A  simple example
 that uses the common combination of <SPAN
CLASS="QUOTE"
>"."</SPAN
> and <SPAN
CLASS="QUOTE"
>"*"</SPAN
> to 
 denote any character, zero or more times. In other words, any string at all.
 So we start with a literal forward slash, then our regular expression pattern 
 (<SPAN
CLASS="QUOTE"
>".*"</SPAN
>) another literal forward slash, the string
 <SPAN
CLASS="QUOTE"
>"banners"</SPAN
>, another forward slash, and lastly another
 <SPAN
CLASS="QUOTE"
>".*"</SPAN
>. We are building 
 a directory path here. This will match any file with the path that has a
 directory named <SPAN
CLASS="QUOTE"
>"banners"</SPAN
> in it. The <SPAN
CLASS="QUOTE"
>".*"</SPAN
> matches
 any characters, and this could conceivably be more forward slashes, so it
 might expand into a much longer looking path. For example, this could match:
 <SPAN
CLASS="QUOTE"
>"/eye/hate/spammers/banners/annoy_me_please.gif"</SPAN
>, or just
 <SPAN
CLASS="QUOTE"
>"/banners/annoying.html"</SPAN
>, or almost an infinite number of other
 possible combinations, just so it has <SPAN
CLASS="QUOTE"
>"banners"</SPAN
> in the path
 somewhere.</P
><P
> A now something a little more complex:</P
><P
> <I
CLASS="EMPHASIS"
><TT
CLASS="LITERAL"
>/.*/adv((er)?ts?|ertis(ing|ements?))?/</TT
></I
> - 
 We have several literal forward slashes again (<SPAN
CLASS="QUOTE"
>"/"</SPAN
>), so we are
 building another expression that is a file path statement. We have another 
 <SPAN
CLASS="QUOTE"
>".*"</SPAN
>, so we are matching against any conceivable sub-path, just so
 it matches our expression. The only true literal that <I
CLASS="EMPHASIS"
>must
 match</I
> our pattern is <SPAN
CLASS="APPLICATION"
>adv</SPAN
>, together with
 the forward slashes. What comes after the <SPAN
CLASS="QUOTE"
>"adv"</SPAN
> string is the
 interesting part. </P
><P
> Remember the <SPAN
CLASS="QUOTE"
>"?"</SPAN
> means the preceding expression (either a
 literal character or anything grouped with <SPAN
CLASS="QUOTE"
>"(...)"</SPAN
> in this case)
 can exist or not, since this means either zero or one match. So
 <SPAN
CLASS="QUOTE"
>"((er)?ts?|ertis(ing|ements?))"</SPAN
> is optional, as are the
 individual sub-expressions: <SPAN
CLASS="QUOTE"
>"(er)"</SPAN
>,
 <SPAN
CLASS="QUOTE"
>"(ing|ements?)"</SPAN
>, and the <SPAN
CLASS="QUOTE"
>"s"</SPAN
>. The <SPAN
CLASS="QUOTE"
>"|"</SPAN
>
 means <SPAN
CLASS="QUOTE"
>"or"</SPAN
>. We have two of those. For instance, 
 <SPAN
CLASS="QUOTE"
>"(ing|ements?)"</SPAN
>, can expand to match either <SPAN
CLASS="QUOTE"
>"ing"</SPAN
> 
 <I
CLASS="EMPHASIS"
>OR</I
> <SPAN
CLASS="QUOTE"
>"ements?"</SPAN
>. What is being done here, is an
 attempt at matching as many variations of <SPAN
CLASS="QUOTE"
>"advertisement"</SPAN
>, and 
 similar, as possible. So this would expand to match just <SPAN
CLASS="QUOTE"
>"adv"</SPAN
>,
 or <SPAN
CLASS="QUOTE"
>"advert"</SPAN
>, or <SPAN
CLASS="QUOTE"
>"adverts"</SPAN
>, or
 <SPAN
CLASS="QUOTE"
>"advertising"</SPAN
>, or <SPAN
CLASS="QUOTE"
>"advertisement"</SPAN
>, or
 <SPAN
CLASS="QUOTE"
>"advertisements"</SPAN
>. You get the idea. But it would not match 
 <SPAN
CLASS="QUOTE"
>"advertizements"</SPAN
> (with a <SPAN
CLASS="QUOTE"
>"z"</SPAN
>). We could fix that by
 changing our regular expression to: 
 <SPAN
CLASS="QUOTE"
>"/.*/adv((er)?ts?|erti(s|z)(ing|ements?))?/"</SPAN
>, which would then match
 either spelling.</P
><P
> <I
CLASS="EMPHASIS"
><TT
CLASS="LITERAL"
>/.*/advert[0-9]+\.(gif|jpe?g)</TT
></I
> - Again 
 another path statement with forward slashes. Anything in the square brackets 
 <SPAN
CLASS="QUOTE"
>"[]"</SPAN
> can be matched. This is using <SPAN
CLASS="QUOTE"
>"0-9"</SPAN
> as a
 shorthand expression to mean any digit one through nine. It is the same as
 saying <SPAN
CLASS="QUOTE"
>"0123456789"</SPAN
>. So any digit matches. The <SPAN
CLASS="QUOTE"
>"+"</SPAN
>
 means one or more of the preceding expression must be included. The preceding 
 expression here is what is in the square brackets -- in this case, any digit 
 one through nine. Then, at the end, we have a grouping: <SPAN
CLASS="QUOTE"
>"(gif|jpe?g)"</SPAN
>. 
 This includes a <SPAN
CLASS="QUOTE"
>"|"</SPAN
>, so this needs to match the expression on
 either side of that bar character also. A simple <SPAN
CLASS="QUOTE"
>"gif"</SPAN
> on one side, and the other
 side will in turn match either <SPAN
CLASS="QUOTE"
>"jpeg"</SPAN
> or <SPAN
CLASS="QUOTE"
>"jpg"</SPAN
>,
 since the <SPAN
CLASS="QUOTE"
>"?"</SPAN
> means the letter <SPAN
CLASS="QUOTE"
>"e"</SPAN
> is optional and
 can be matched once or not at all. So we are building an expression here to
 match image GIF or JPEG type image file. It must include the literal
 string <SPAN
CLASS="QUOTE"
>"advert"</SPAN
>, then one or more digits, and a <SPAN
CLASS="QUOTE"
>"."</SPAN
>
 (which is now a literal, and not a special character, since it is escaped
 with <SPAN
CLASS="QUOTE"
>"\"</SPAN
>), and lastly either <SPAN
CLASS="QUOTE"
>"gif"</SPAN
>, or
 <SPAN
CLASS="QUOTE"
>"jpeg"</SPAN
>, or <SPAN
CLASS="QUOTE"
>"jpg"</SPAN
>. Some possible matches would
 include: <SPAN
CLASS="QUOTE"
>"//advert1.jpg"</SPAN
>,
 <SPAN
CLASS="QUOTE"
>"/nasty/ads/advert1234.gif"</SPAN
>,
 <SPAN
CLASS="QUOTE"
>"/banners/from/hell/advert99.jpg"</SPAN
>. It would not match
 <SPAN
CLASS="QUOTE"
>"advert1.gif"</SPAN
> (no leading slash), or
 <SPAN
CLASS="QUOTE"
>"/adverts232.jpg"</SPAN
> (the expression does not include an
 <SPAN
CLASS="QUOTE"
>"s"</SPAN
>), or <SPAN
CLASS="QUOTE"
>"/advert1.jsp"</SPAN
> (<SPAN
CLASS="QUOTE"
>"jsp"</SPAN
> is not
 in the expression anywhere).</P
><P
> <I
CLASS="EMPHASIS"
><TT
CLASS="LITERAL"
>s/microsoft(?!.com)/MicroSuck/i</TT
></I
> - This is 
 a substitution. <SPAN
CLASS="QUOTE"
>"MicroSuck"</SPAN
> will replace any occurrence of 
 <SPAN
CLASS="QUOTE"
>"microsoft"</SPAN
>.  The <SPAN
CLASS="QUOTE"
>"i"</SPAN
> at the end of the expression
 means ignore case. The <SPAN
CLASS="QUOTE"
>"(?!.com)"</SPAN
> means 
 the match should fail if <SPAN
CLASS="QUOTE"
>"microsoft"</SPAN
> is followed by
 <SPAN
CLASS="QUOTE"
>".com"</SPAN
>. In other words, this acts like a <SPAN
CLASS="QUOTE"
>"NOT"</SPAN
>
 modifier. In case this is a hyperlink, we don't want to break it ;-).</P
><P
> We are barely scratching the surface of regular expressions here so that you
 can understand the default <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
>
 configuration files, and maybe use this knowledge to customize your own
 installation. There is much, much more that can be done with regular
 expressions. Now that you know enough to get started, you can learn more on
 your own :/</P
><P
> More reading on Perl Compatible Regular expressions: 
 <A
HREF="http://www.perldoc.com/perl5.6/pod/perlre.html"
TARGET="_top"
>http://www.perldoc.com/perl5.6/pod/perlre.html</A
></P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN1613"
>9.2. <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
>'s Internal Pages</A
></H2
><P
> Since <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> proxies each requested 
 web page, it is easy for <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> to 
 trap certain special URLs. In this way, we can talk directly to
 <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
>, and see how it is 
 configured, see how our rules are being applied, change these 
 rules and other configuration options, and even turn
 <SPAN
CLASS="APPLICATION"
>Privoxy's</SPAN
> filtering off, all with 
 a web browser.&#13;</P
><P
> The URLs listed below are the special ones that allow direct access 
 to <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
>. Of course,
 <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> must be running to access these. If 
 not, you will get a friendly error message. Internet access is not 
 necessary either.</P
><P
> <P
></P
><UL
><LI
><P
>  
   Privoxy main page: 
  </P
><A
NAME="AEN1628"
></A
><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
> 
     <A
HREF="http://config.privoxy.org/"
TARGET="_top"
>http://config.privoxy.org/</A
>
   </P
></BLOCKQUOTE
><P
>   Alternately, this may be reached at <A
HREF="http://p.p/"
TARGET="_top"
>http://p.p/</A
>, but this
   variation may not work as reliably as the above in some configurations.
  </P
></LI
><LI
><P
>  
    Show information about the current configuration: 
  </P
><A
NAME="AEN1635"
></A
><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
> 
    <A
HREF="http://config.privoxy.org/show-status"
TARGET="_top"
>http://config.privoxy.org/show-status</A
>
   </P
></BLOCKQUOTE
></LI
><LI
><P
>  
    Show the source code version numbers:
  </P
><A
NAME="AEN1640"
></A
><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
> 
    <A
HREF="http://config.privoxy.org/show-version"
TARGET="_top"
>http://config.privoxy.org/show-version</A
>
   </P
></BLOCKQUOTE
></LI
><LI
><P
>  
   Show the client's request headers:
  </P
><A
NAME="AEN1645"
></A
><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
> 
    <A
HREF="http://config.privoxy.org/show-request"
TARGET="_top"
>http://config.privoxy.org/show-request</A
>
   </P
></BLOCKQUOTE
></LI
><LI
><P
>  
   Show which actions apply to a URL and why:
  </P
><A
NAME="AEN1650"
></A
><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
> 
    <A
HREF="http://config.privoxy.org/show-url-info"
TARGET="_top"
>http://config.privoxy.org/show-url-info</A
>
   </P
></BLOCKQUOTE
></LI
><LI
><P
>  
   Toggle Privoxy on or off. In this case, <SPAN
CLASS="QUOTE"
>"Privoxy"</SPAN
> continues 
   to run, but only as a pass-through proxy, with no actions taking place:
  </P
><A
NAME="AEN1656"
></A
><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
> 
    <A
HREF="http://config.privoxy.org/toggle"
TARGET="_top"
>http://config.privoxy.org/toggle</A
>
   </P
></BLOCKQUOTE
><P
>   Short cuts. Turn off, then on: 
  </P
><A
NAME="AEN1660"
></A
><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
> 
     <A
HREF="http://config.privoxy.org/toggle?set=disable"
TARGET="_top"
>http://config.privoxy.org/toggle?set=disable</A
>
   </P
></BLOCKQUOTE
><A
NAME="AEN1663"
></A
><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
> 
     <A
HREF="http://config.privoxy.org/toggle?set=enable"
TARGET="_top"
>http://config.privoxy.org/toggle?set=enable</A
>
   </P
></BLOCKQUOTE
></LI
><LI
><P
>  
   Edit the actions list file:
  </P
><A
NAME="AEN1668"
></A
><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
> 
    <A
HREF="http://config.privoxy.org/edit-actions"
TARGET="_top"
>http://config.privoxy.org/edit-actions</A
>
   </P
></BLOCKQUOTE
></LI
></UL
></P
><P
> These may be bookmarked for quick reference.&#13;</P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="BOOKMARKLETS"
>9.2.1. Bookmarklets</A
></H3
><P
> Below are some <SPAN
CLASS="QUOTE"
>"bookmarklets"</SPAN
> to allow you to easily access a
 <SPAN
CLASS="QUOTE"
>"mini"</SPAN
> version of some of <SPAN
CLASS="APPLICATION"
>Privoxy's</SPAN
>
 special pages. They are designed for MS Internet Explorer, but should work
 equally well in Netscape, Mozilla, and other browsers which support
 JavaScript. They are designed to run directly from your bookmarks - not by
 clicking the links below (although that should work for testing).</P
><P
> To save them, right-click the link and choose <SPAN
CLASS="QUOTE"
>"Add to Favorites"</SPAN
>
 (IE) or <SPAN
CLASS="QUOTE"
>"Add Bookmark"</SPAN
> (Netscape). You will get a warning that
 the bookmark <SPAN
CLASS="QUOTE"
>"may not be safe"</SPAN
> - just click OK. Then you can run the
 Bookmarklet directly from your favourites/bookmarks. For even faster access,
 you can put them on the <SPAN
CLASS="QUOTE"
>"Links"</SPAN
> bar (IE) or the <SPAN
CLASS="QUOTE"
>"Personal
 Toolbar"</SPAN
> (Netscape), and run them with a single click. </P
><P
> <P
></P
><UL
><LI
><P
>    <A
HREF="javascript:void(window.open('http://config.privoxy.org/toggle?mini=y&set=enabled','ijbstatus','width=250,height=100,resizable=yes,scrollbars=no,toolbar=no,location=no,directories=no,status=no,menubar=no,copyhistory=no').focus());"
TARGET="_top"
>Enable Privoxy</A
>
   </P
></LI
><LI
><P
>    <A
HREF="javascript:void(window.open('http://config.privoxy.org/toggle?mini=y&set=disabled','ijbstatus','width=250,height=100,resizable=yes,scrollbars=no,toolbar=no,location=no,directories=no,status=no,menubar=no,copyhistory=no').focus());"
TARGET="_top"
>Disable Privoxy</A
>
   </P
></LI
><LI
><P
>    <A
HREF="javascript:void(window.open('http://config.privoxy.org/toggle?mini=y&set=toggle','ijbstatus','width=250,height=100,resizable=yes,scrollbars=no,toolbar=no,location=no,directories=no,status=no,menubar=no,copyhistory=no').focus());"
TARGET="_top"
>Toggle Privoxy</A
> (Toggles between enabled and disabled)
   </P
></LI
><LI
><P
>    <A
HREF="javascript:void(window.open('http://config.privoxy.org/toggle?mini=y','ijbstatus','width=250,height=2,resizable=yes,scrollbars=no,toolbar=no,location=no,directories=no,status=no,menubar=no,copyhistory=no').focus());"
TARGET="_top"
>View Privoxy Status</A
>
   </P
></LI
><LI
><P
>    <A
HREF="javascript:w=Math.floor(screen.width/2);h=Math.floor(screen.height*0.9);void(window.open('http://www.privoxy.org/actions','Feedback','screenx='+w+',width='+w+',height='+h+',scrollbars=yes,toolbar=no,location=no,directories=no,status=no,menubar=no,copyhistory=no').focus());"
TARGET="_top"
>Actions file feedback system</A
>
   </P
></LI
></UL
></P
><P
> Credit: The site which gave me the general idea for these bookmarklets is
 <A
HREF="http://www.bookmarklets.com"
TARGET="_top"
>www.bookmarklets.com</A
>. They
 have more information about bookmarklets. </P
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="ACTIONSANAT"
>9.3. Anatomy of an Action</A
></H2
><P
> The way <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> applies <SPAN
CLASS="QUOTE"
>"actions"</SPAN
>
 and <SPAN
CLASS="QUOTE"
>"filters"</SPAN
> to any given URL can be complex, and not always so
 easy to understand what is happening. And sometimes we need to be able to
 <I
CLASS="EMPHASIS"
>see</I
> just what <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> is
 doing. Especially, if something <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> is doing
 is causing us a problem inadvertantly. It can be a little daunting to look at
 the actions and filters files themselves, since they tend to be filled with
 <SPAN
CLASS="QUOTE"
>"regular expressions"</SPAN
> whose consequences are not always 
 so obvious. <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> provides the 
 <A
HREF="http://config.privoxy.org/show-url-info"
TARGET="_top"
>http://config.privoxy.org/show-url-info</A
>
 page that can show us very specifically how <SPAN
CLASS="APPLICATION"
>actions</SPAN
>
 are being applied to any given URL. This is a big help for troubleshooting.
 </P
><P
> First, enter one URL (or partial URL) at the prompt, and then
 <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> will tell us 
 how the current configuration will handle it. This will not
 help with filtering effects from the <TT
CLASS="FILENAME"
>default.filter</TT
> file! It
 also will not tell you about any other URLs that may be embedded within the
 URL you are testing. For instance, images such as ads are expressed as URLs
 within the raw page source of HTML pages. So you will only get info for the
 actual URL that is pasted into the prompt area -- not any sub-URLs. If you
 want to know about embedded URLs like ads, you will have to dig those out of
 the HTML source. Use your browser's <SPAN
CLASS="QUOTE"
>"View Page Source"</SPAN
> option
 for this. Or right click on the ad, and grab the URL.</P
><P
> Let's look at an example, <A
HREF="http://google.com"
TARGET="_top"
>google.com</A
>, 
 one section at a time:</P
><P
> <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
> System default actions:

 { -add-header -block -deanimate-gifs -downgrade -fast-redirects -filter 
   -hide-forwarded -hide-from -hide-referer -hide-user-agent -image 
   -image-blocker -limit-connect -no-compression -no-cookies-keep 
   -no-cookies-read -no-cookies-set -no-popups -vanilla-wafer -wafer }
 
 </PRE
></TD
></TR
></TABLE
></P
><P
> This is the top section, and only tells us of the compiled in defaults. This 
 is basically what <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> would do if there 
 were not any <SPAN
CLASS="QUOTE"
>"actions"</SPAN
> defined, i.e. it does nothing. Every action 
 is disabled. This is not particularly informative for our purposes here. OK,
 next section:</P
><P
> <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13; Matches for http://google.com:

 { -add-header -block +deanimate-gifs -downgrade +fast-redirects 
   +filter{html-annoyances} +filter{js-annoyances} +filter{no-popups} 
   +filter{webbugs} +filter{nimda} +filter{banners-by-size} +filter{hal} 
   +filter{fun} +hide-forwarded +hide-from{block} +hide-referer{forge} 
   -hide-user-agent -image +image-blocker{blank} +no-compression 
   +no-cookies-keep -no-cookies-read -no-cookies-set +no-popups 
   -vanilla-wafer -wafer }
   /

 { -no-cookies-keep -no-cookies-read -no-cookies-set }
  .google.com

 { -fast-redirects }
  .google.com

 </PRE
></TD
></TR
></TABLE
></P
><P
> This is much more informative, and tells us how we have defined our 
 <SPAN
CLASS="QUOTE"
>"actions"</SPAN
>, and which ones match for our example, 
 <SPAN
CLASS="QUOTE"
>"google.com"</SPAN
>. The first grouping shows our default 
 settings, which would apply to all URLs. If you look at your <SPAN
CLASS="QUOTE"
>"actions"</SPAN
>
 file, this would be the section just below the <SPAN
CLASS="QUOTE"
>"aliases"</SPAN
> section 
 near the top. This applies to all URLs as signified by the single forward
 slash -- <SPAN
CLASS="QUOTE"
>"/"</SPAN
>.
 </P
><P
> These are the default actions we have enabled. But we can define additional
 actions that would be exceptions to these general rules, and then list 
 specific URLs that these exceptions would apply to. Last match wins.
 Just below this then are two explict matches for <SPAN
CLASS="QUOTE"
>".google.com"</SPAN
>.
 The first is negating our various cookie blocking actions (i.e. we will allow
 cookies here). The second is allowing <SPAN
CLASS="QUOTE"
>"fast-redirects"</SPAN
>. Note
 that there is a leading dot here -- <SPAN
CLASS="QUOTE"
>".google.com"</SPAN
>. This will
 match any hosts and sub-domains, in the google.com domain also, such as
 <SPAN
CLASS="QUOTE"
>"www.google.com"</SPAN
>. So, apparently, we have these actions defined
 somewhere in the lower part of our actions file, and
 <SPAN
CLASS="QUOTE"
>"google.com"</SPAN
> is referenced in these sections.&#13;</P
><P
> And now we pull it altogether in the bottom section and summarize how
 <SPAN
CLASS="APPLICATION"
>Privoxy</SPAN
> is appying all its <SPAN
CLASS="QUOTE"
>"actions"</SPAN
> 
 to <SPAN
CLASS="QUOTE"
>"google.com"</SPAN
>:&#13;</P
><P
> <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13; Final results:

 -add-header -block -deanimate-gifs -downgrade -fast-redirects 
 +filter{html-annoyances} +filter{js-annoyances} +filter{no-popups} 
 +filter{webbugs} +filter{nimda} +filter{banners-by-size} +filter{hal} 
 +filter{fun} +hide-forwarded +hide-from{block} +hide-referer{forge} 
 -hide-user-agent -image +image-blocker{blank} -limit-connect +no-compression 
 -no-cookies-keep -no-cookies-read -no-cookies-set +no-popups -vanilla-wafer 
 -wafer

 </PRE
></TD
></TR
></TABLE
></P
><P
> Now another example, <SPAN
CLASS="QUOTE"
>"ad.doubleclick.net"</SPAN
>:</P
><P
> <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13; { +block +image }
  .ad.doubleclick.net

 { +block +image }
  ad*.

 { +block +image }
  .doubleclick.net

 </PRE
></TD
></TR
></TABLE
></P
><P
> We'll just show the interesting part here, the explicit matches. It is 
 matched three different times. Each as an <SPAN
CLASS="QUOTE"
>"+block +image"</SPAN
>,
 which is the expanded form of one of our aliases that had been defined as: 
 <SPAN
CLASS="QUOTE"
>"+imageblock"</SPAN
>. (<SPAN
CLASS="QUOTE"
>"Aliases"</SPAN
> are defined in the 
 first section of the actions file and typically used to combine more 
 than one action.)</P
><P
> Any one of these would have done the trick and blocked this as an unwanted 
 image. This is unnecessarily redundant since the last case effectively 
 would also cover the first. No point in taking chances with these guys 
 though ;-) Note that if you want an ad or obnoxious 
 URL to be invisible, it should be defined as <SPAN
CLASS="QUOTE"
>"ad.doubleclick.net"</SPAN
>
 is done here -- as both a <SPAN
CLASS="QUOTE"
>"+block"</SPAN
> <I
CLASS="EMPHASIS"
>and</I
> an
 <SPAN
CLASS="QUOTE"
>"+image"</SPAN
>. The custom alias <SPAN
CLASS="QUOTE"
>"+imageblock"</SPAN
> does this
 for us.</P
><P
> One last example. Let's try <SPAN
CLASS="QUOTE"
>"http://www.rhapsodyk.net/adsl/HOWTO/"</SPAN
>.
 This one is giving us problems. We are getting a blank page. Hmmm...</P
><P
> <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13; Matches for http://www.rhapsodyk.net/adsl/HOWTO/:

 { -add-header -block +deanimate-gifs -downgrade +fast-redirects 
   +filter{html-annoyances} +filter{js-annoyances} +filter{no-popups} 
   +filter{webbugs} +filter{nimda} +filter{banners-by-size} +filter{hal} 
   +filter{fun} +hide-forwarded +hide-from{block} +hide-referer{forge} 
   -hide-user-agent -image +image-blocker{blank} +no-compression 
   +no-cookies-keep -no-cookies-read -no-cookies-set +no-popups 
   -vanilla-wafer -wafer }
   /

 { +block +image }
  /ads

 </PRE
></TD
></TR
></TABLE
></P
><P
> Ooops, the <SPAN
CLASS="QUOTE"
>"/adsl/"</SPAN
> is matching <SPAN
CLASS="QUOTE"
>"/ads"</SPAN
>! But 
 we did not want this at all! Now we see why we get the blank page. We could
 now add a new action below this that explictly does <I
CLASS="EMPHASIS"
>not</I
>
 block (-block) pages with <SPAN
CLASS="QUOTE"
>"adsl"</SPAN
>. There are various ways to
 handle such exceptions. Example:</P
><P
> <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13; { -block }
  /adsl
 
 </PRE
></TD
></TR
></TABLE
></P
><P
> Now the page displays ;-) Be sure to flush your browser's caches when 
 making such changes. Or, try using <TT
CLASS="LITERAL"
>Shift+Reload</TT
>.</P
><P
> But now what about a situation where we get no explicit matches like 
 we did with:</P
><P
> <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13; { -block }
  /adsl
 
 </PRE
></TD
></TR
></TABLE
></P
><P
> That actually was very telling and pointed us quickly to where the problem
 was. If you don't get this kind of match, then it means one of the default 
 rules in the first section is causing the problem. This would require some 
 guesswork, and maybe a little trial and error to isolate the offending rule.
 One likely cause would be one of the <SPAN
CLASS="QUOTE"
>"{+filter}"</SPAN
> actions. Try 
 adding the URL for the site to one of aliases that turn off <SPAN
CLASS="QUOTE"
>"+filter"</SPAN
>:</P
><P
> <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13; {shop}
 .quietpc.com
 .worldpay.com   # for quietpc.com
 .jungle.com
 .scan.co.uk
 .forbes.com
 
 </PRE
></TD
></TR
></TABLE
></P
><P
> <SPAN
CLASS="QUOTE"
>"{shop}"</SPAN
> is an <SPAN
CLASS="QUOTE"
>"alias"</SPAN
> that expands to 
 <SPAN
CLASS="QUOTE"
>"{ -filter -no-cookies -no-cookies-keep }"</SPAN
>. Or you could do 
 your own exception to negate filtering:&#13;</P
><P
> <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>&#13; {-filter}
 .forbes.com
 
 </PRE
></TD
></TR
></TABLE
></P
><P
> <SPAN
CLASS="QUOTE"
>"{fragile}"</SPAN
> is an alias that disables most actions. This can be 
 used as a last resort for problem sites. Remember to flush caches! If this 
 still does not work, you will have to go through the remaining actions one by
 one to find which one(s) is causing the problem.</P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="seealso.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>&nbsp;</TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>See Also</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>&nbsp;</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>